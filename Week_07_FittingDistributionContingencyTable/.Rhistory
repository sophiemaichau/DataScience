xlim(c(0,15000)) +
ylim(c(0,15))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +\
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_x_continuous(breaks = seq(0,5000,1000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_x_continuous(breaks = seq(0,5000,1000)) +
scale_x_continuous(breaks = seq(0,5,10))
ggplot(HumanGeneLengths, aes(x='Human Gene Length (pb)')) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_x_continuous(breaks = seq(0,5000,1000)) +
scale_x_continuous(breaks = seq(0,5,10))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_x_continuous(breaks = seq(0,5000,1000)) +
scale_x_continuous(breaks = seq(0,5,10))
?scale_x_continuous
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_x_continuous(name='Human Gene length', breaks = seq(0,5000,1000)) +
scale_x_continuous(breaks = seq(0,5,10))
?scale_x_continuous
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_x_continuous(labels='Human Gene length', breaks = seq(0,5000,1000)) +
scale_x_continuous(breaks = seq(0,5,10))
ggplot(HumanGeneLengths, aes(x='gene.length')) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_x_continuous(labels='Human Gene length', breaks = seq(0,5000,1000)) +
scale_x_continuous(breaks = seq(0,5,10))
ggplot(HumanGeneLengths, aes(x='gene.length')) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_x_continuous(breaks = seq(0,5000,1000)) +
scale_x_continuous(breaks = seq(0,5,10))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_x_continuous(breaks = seq(0,5000,1000)) +
scale_x_continuous(breaks = seq(0,5,10))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000)) +
scale_x_continuous(breaks = seq(0,5000,1000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000)) +
scale_y_continuous(breaks = seq(0,5,10))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000)) +
scale_y_continuous(breaks = seq(0,5,10, 15))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000)) +
scale_y_continuous(breaks = seq(5,10, 15))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000)) +
scale_y_continuous(name='obs')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000)) +
scale_y_continuous(name='observed counts')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000)) +
scale_y_continuous(name='observed counts') +
scale_y_continuous(name='Human Gene length')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000)) +
scale_y_continuous(name='observed counts') +
scale_x_continuous(name='Human Gene length')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000)) +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000)) +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000)) +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000)) +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)')
?scale_x_continuous
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_y_continuous(name='Observed counts', breaks = waiver()) +
scale_x_continuous(name='Human Gene length (pb)')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_y_continuous(name='Observed counts', breaks = (0,5000,10000,15000)) +
scale_x_continuous(name='Human Gene length (pb)')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_y_continuous(name='Observed counts', breaks=c(0,15000)) +
scale_x_continuous(name='Human Gene length (pb)')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_y_continuous(name='Observed counts', breaks=c(0,15)) +
scale_x_continuous(name='Human Gene length (pb)')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)', breaks=c(0,15000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)', breaks=xlim(c(0,15000)))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)', breaks=c(0,15000))
points(0,5000,10000,15000)
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)', breaks=points(0,5000,10000,15000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='100') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)')
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='100') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)') +
xlim(c(0,15000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)') +
xlim(c(0,15000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='20') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)') +
xlim(c(0,15000))
?xlim
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='20') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)') +
xlim(c(0,15000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='20') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)', limits=c(0,15000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='30') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)', limits=c(0,15000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='13') +
xlim(c(0,15000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='20') +
xlim(c(0,15000))
ggplot(HumanGeneLengths, aes(x=gene.length)) +
geom_histogram(colour='black', fill='red', bins='30') +
scale_y_continuous(name='Observed counts') +
scale_x_continuous(name='Human Gene length (pb)', limits=c(0,15000))
MySmallSample= sample(x = HumanGeneLengths$gene.length, size = 30, replace = T) ## 30 genes sampled WITH replacement
MySmallSample
MySmallSample= sample(x = HumanGeneLengths$gene.length, size = 30, replace = F)
MySmallSample
?sample
?sample
?sample
?sample
MySmallSample= sample(x = HumanGeneLengths$gene.length, size = 30, replace = T) ## 30 genes sampled WITH replacement
ms = sample(x = HumanGeneLengths$gene.length, size = 30, replace = T)
ms = sample(x = HumanGeneLengths$gene.length, size = 30, replace = F)
MySmallSample
ms
MySmallSample
ms
MySmallSample
MySmallSample
ms
MyBigSample= sample(x = HumanGeneLengths$gene.length, size = length(HumanGeneLengths$gene.length), replace = F)
summary(MyBigSample)
summary(MyBigSample)
myNewMean=mean(myNewSample)
summary(my100Means)
a1 <- data.frame(HumanGeneLengths)
a1
a1 <- data.frame(summary(HumanGeneLengths))
a1
a2 <- data.frame(summary(my100Means))
a2 <- data.frame(my100Means)
a2
a1 <- data.frame()
a1 <- data.frame(HumanGeneLengths)
comparison <- compare(a1,a2,allowAll=TRUE)
library(compare)
install.packages('compare')
library(compare)
comparison <- compare(a1,a2,allowAll=TRUE)
comparison
summary(my100Means)
summary(HumanGeneLengths)
comparison <- compare(a1,a2,allowAll=TRUE)
comparison
summary(my100Means)
summary(HumanGeneLengths)
a1
a2
a1
a2
a1 <- data.frame(HumanGeneLengths)
a1 <- slice(data.frame(HumanGeneLengths), 1:100)
a1
comparison <- compare(a1,a2,allowAll=TRUE)
comparison
summary(my100Means)
summary(HumanGeneLengths)
data.table(HumanGeneLengths)
install.packages('data.table')
library(data.table)
data.table(HumanGeneLengths)
data.table(t(HumanGeneLengths))
a1
a2
a1
summary(my100Means)
summary(HumanGeneLengths)
HumanGeneLengths
summary(HumanGeneLengths)
summary(my100Means)
my100Means=rep(-9,100)
my100Means[i]=myNewMean
my100Means
my100Means=rep(-9,100)
for (i in 1:100){
myNewSample=sample(HumanGeneLengths$gene.length, size = 30, replace = T)
myNewMean=mean(myNewSample)
my100Means[i]=myNewMean
}
summary(my100Means)
summary(HumanGeneLengths)
summary(sample(HumanGeneLengths$gene.length))
summary(my100Means)
summary(sample(HumanGeneLengths$gene.length))
m100 <- summary(my100Means)
hgl <- summary(sample(HumanGeneLengths$gene.length))
comparison <- compare(m100,hgl,allowAll=TRUE)
Show(m100)
View(m100)
View(m100)
m100
hgl
my5000Means=rep(-9,5000)
for (i in 1:5000){
myNewSample=sample(HumanGeneLengths$gene.length, size = 30, replace = T)
myNewMean=mean(myNewSample)
my100Means[i]=myNewMean
}
m5000 <- summary(my5000Means)
hgl2 <- summary(sample(HumanGeneLengths$gene.length))
m5000
my5000Means=rep(-9,5000)
for (i in 1:5000){
myNewSample=sample(HumanGeneLengths$gene.length, size = 30, replace = T)
myNewMean=mean(myNewSample)
my100Means[i]=myNewMean
}
m5000 <- summary(my5000Means)
hgl2 <- summary(sample(HumanGeneLengths$gene.length))
m5000
hgl2
m100 <- summary(my100Means)
m100
filter(m100, Mean)
m100
my100Means
filter(m100)
m100
hgl
hgl <- summary(sample(HumanGeneLengths$gene.length))
m100
hgl
my5000Means=rep(-9,5000)
for (i in 1:5000){
myNewSample=sample(HumanGeneLengths$gene.length, size = 30, replace = T)
myNewMean=mean(myNewSample)
my100Means[i]=myNewMean
}
m5000 <- summary(my5000Means)
m5000
hgl2 <- summary(sample(HumanGeneLengths$gene.length))
hgl2
my100Means[i]=myNewMean
for (i in 1:5000){
myNewSample=sample(HumanGeneLengths$gene.length, size = 30, replace = T)
myNewMean=mean(myNewSample)
my100Means[i]=myNewMean
}
m5000
myNewSample=sample(HumanGeneLengths$gene.length, size = 00, replace = T)
myNewSample=sample(HumanGeneLengths$gene.length, size = 100, replace = T)
m5000 <- summary(my5000Means)
m5000
3
m5000 <- summary(my5000Means)
hgl2 <- summary(sample(HumanGeneLengths$gene.length))
m5000
hgl2
my5000Means=rep(-9,100)
for (i in 1:5000){
myNewSample=sample(HumanGeneLengths$gene.length, size = 30, replace = T)
myNewMean=mean(myNewSample)
my100Means[i]=myNewMean
}
m5000 <- summary(my5000Means)
m5000
my5000Means=rep(-9,5000)
for (i in 1:100){
myNewSample=sample(HumanGeneLengths$gene.length, size = 30, replace = T)
myNewMean=mean(myNewSample)
my100Means[i]=myNewMean
}
m5000 <- summary(my5000Means)
m5000
my5000Means=rep(-9,5000)
for (i in 1:5000){
myNewSample=sample(HumanGeneLengths$gene.length, size = 30, replace = T)
myNewMean=mean(myNewSample)
my100Means[i]=myNewMean
}
m5000 <- summary(my5000Means)
hgl2 <- summary(sample(HumanGeneLengths$gene.length))
m5000
hgl2
log(0.5) < log(0.01)
dbinom(10, 25, prob, log = FALSE)
dbinom(x=10, size=25, prob=0.061, log = FALSE)
dbinom(x=10:25, size=25, prob=0.061, log = FALSE)
sum(dbinom(x=0:25, size=25, prob=0.061, log = FALSE))
sum(dbinom(x=10:25, size=25, prob=0.061, log = FALSE))
2*sum(dbinom(x=10:25, size=25, prob=0.061, log = FALSE))
pbinom(q=9, size=25, p=0.061, lower.tail = F)
pbinom(q=9, size=25, p=0.061)
, lower.tail = F
binom.test(x=10, size=25, p=0.061)
pbinom(q=9, size=25, p=0.061, lower.tail = F)
binom.test(x=10, =25, p=0.061)
binom.test(x=10, n=25, p=0.061)
binom.test(x=10, n=25, p=0.061, tail = 2)
binom.test(x=10, n=25, p=0.061)
10/25
binom.test(x=2, n=12, p=1/6)
3/12
2/12
3/12
1/6
binom.test(x=3, n=12, p=1/6)
binom.test(x=2, n=12, p=1/6) #if you guess 5 correct, it's significant more than expected
binom.test(x=3, n=12, p=1/6)
(1/6*(1-1/6))/12
sqrt((1/6*(1-1/6))/12)
p <- 0.25
sqrt((p*(1-p))/12)
diffpropci.Wald.mp(-1.96, 1.96, 12, conf.level=1.96)
new <- 1.96 * sqrt((p(1-p)/12+4)
(p-1.96*(p))
new <- 1.96 * sqrt((p(1-p)/12+4))
new
new <- 1.96 * sqrt((p*(1-p))/12+4)
new
p - new
p + new
0/12
sqrt((0*(1-0))/12)
(1/6*2)
(2/12*2)
(2/12)*2
1/6
(1/6)*2
12/0.33
12*0.33
12*0.05
binom.test(x=3, n=12, p=1/6)
120*0.05
2*0.05
arr <- c(1,2,3,4)
arr[0]
arr[1]
library(tidyverse)
d = read_delim(file = "dgrp2.tgeno", delim = c(" "),
col_type = cols_only(chr='c', pos='i', id='c', ref='c', alt='c', refc='i', altc='i', cov='i')
)
setwd("~/Google Drev/Data Science in Bioinformatics/Dropbox.Data.Science.in.Bioinformatics/Week_07_FittingDistributionContingencyTable")
d = read_delim(file = "dgrp2.tgeno", delim = c(" "),
col_type = cols_only(chr='c', pos='i', id='c', ref='c', alt='c', refc='i', altc='i', cov='i')
)
d = read_delim(file = "dgrp2.tgeno", delim = c(" "),
col_type = cols_only(chr='c', pos='i', id='c', ref='c', alt='c', refc='i', altc='i', cov='i')
)
setwd("~/Google Drev/Data Science in Bioinformatics/Dropbox.Data.Science.in.Bioinformatics/Week_07_FittingDistributionContingencyTable")
d = read_delim(file = "dgrp2.tgeno", delim = c(" "),
col_type = cols_only(chr='c', pos='i', id='c', ref='c', alt='c', refc='i', altc='i', cov='i')
)
setwd("~/Google Drev/Data Science in Bioinformatics/Dropbox.Data.Science.in.Bioinformatics/Week_07_FittingDistributionContingencyTable")
library(tidyverse)
d = read_delim(file = "dgrp2.tgeno", delim = c(" "),
col_type = cols_only(chr='c', pos='i', id='c', ref='c', alt='c', refc='i', altc='i', cov='i')
)
snp_100 = d %>%
filter(chr=="3L", nchar(ref)==1, nchar(alt)==1, refc > 0, altc > 0)
# Slice up the data set (takes the first 100.000 SNPs)
snp_100 <-slice(snp_100, 1:100000)
# The table now looks like this:
View(snp_100)
# Initialising the number of lines (line_21,line_26,...,line_913) that we excluded earlier
line_numbers <- 205
# Inserting columns: filter and lines_genotyped
# filter can be used when filtering out all SNPs less than the filter number (SNP individuals that could be genotyped)
# lines_genotyped used in next question, where we want to plot the distribution lines genotyped.
snp_100 <- snp_100 %>%
mutate(filter=(refc+altc)/line_numbers, lines_genotyped=refc+altc)
# The table now looks like this:
View(snp_100)
# Now we filter out all SNPs for which less than 75%, 80%, 90% and 95%. The next lines output how many SNPs are left after filtering:
nrow(filter(snp_100, filter >= 0.75)) # 98.195
nrow(filter(snp_100, filter >= 0.80)) # 97.673
nrow(filter(snp_100, filter >= 0.85)) # 96.942
nrow(filter(snp_100, filter >= 0.90)) # 95.625
nrow(filter(snp_100, filter >= 0.95)) # 90.725
# Now we restrict our attention to SNPs genotyped in at least 95% of individuals:
snp_100 <- filter(snp_100, filter >= 0.95)
#### Q2 ####
### Graph distributions over SNP: allele frequencies, coverage and lines genotyped ###
# Distribution of SNP allele frequency
ggplot(snp_100) +
geom_histogram(aes(altc, color="alternative"), bins=30) +
geom_histogram(aes(refc, color="reference"), bins=30) +
xlim(c(0,100)) +
labs(title="Distribution of SNP allele frequencies") +
xlab("Allele Frequency") +
ylab("Number of SNPs")
# Calculating and inserting minor alle frequency(MAF) as column:
snp_100 <- snp_100 %>%
mutate(maf=ifelse(altc < refc, altc/(altc+refc), refc/(altc+refc)))
View(snp_100)
# Distribution of coverage of SNPs, looks like a normal distribution
ggplot(snp_100, aes(x=cov)) +
geom_histogram(binwidth = 0.5) +
xlim(c(0,70)) +
labs(title="Distribution of coverage of SNPs") +
xlab("Coverage(x)") +
ylab("Number of SNPs")
# Distribution of number of lines genotyped for each SNP. Using geom_bar because we work with discrete variables.
ggplot(snp_100, aes(x=lines_genotyped)) +
geom_bar() +
labs(title="Distribution of number of lines genotyped for each SNP") +
xlab("Number of lines genotyped") +
ylab("Number of SNPs")
### Statistical association
# Adding two columns with frequency for "true" SNPs with positions where A/T - and G/C are found
# and filtering away all SNPs where no "true" SNPs are found.
# Here we use alternative count (altc) as allele frequency.
snp_100 <- snp_100 %>%
mutate(at_freq=ifelse(ref %in% c("A","T") & alt %in% c("A","T"),altc,0)) %>%
mutate(gc_freq=ifelse(ref %in% c("G","C") & alt %in% c("G","C"),altc,0)) %>%
filter((at_freq > 0) | (gc_freq > 0))
# Distribution of SNP allele frequencies with positions where A/T - and G/C are found
ggplot(snp_100) +
geom_bar(aes(x=at_freq, colour="A/T")) +
geom_bar(aes(x=gc_freq, colour="G/C")) +
xlim(c(0,100)) +
ylim(c(0,3000)) +
labs(title="Distribution of SNP allele frequencies") +
xlab("Alternative Allele Frequency") +
ylab("Number of SNPs")
