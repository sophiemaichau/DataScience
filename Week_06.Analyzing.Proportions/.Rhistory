filter(maf > 0) %>%
mutate(population=factor(population),
reference_allele=factor(reference_allele),
alternative_allele=factor(alternative_allele))
summary(d)
d <- d %>%
mutate(bin25k = position %/% 25000)
names(d)
d %>% head(3)
d <- d %>% mutate(n20=ifelse(maf>0.2, 1, 0))
d <- d %>% mutate(n=ifelse(bin25k==bin25k, sum(n20), 0))
d <- d %>% mutate(ts=ifelse(n20!=0, n20/n, 0))
d
x <- d %>%
filter(bin25k == median(bin25k))
x
d %>% head(3)
d <- d %>%
mutate(bin25k = (position %/% 25000) * 25000)
names(d)
d %>% head(3)
d %>% head(3)
d <- d %>% mutate(n20=ifelse(maf>0.2, 1, 0))
d <- d %>% mutate(n=ifelse(bin25k==bin25k, sum(n20), 0))
d <- d %>% mutate(ts=ifelse(n20!=0, n20/n, 0))
d
x <- d %>%
filter(bin25k == median(bin25k))
x
select(x[144,], position) # position value: 80.762.476
d
d[20:60,]
new_d <- d %>%
summarise(
n20 = sum(maf > 0.2),
n = n(),
ts = n20/n,
x = (min(position)+max(position)/2)
)
new_d
d
new_d <- d %>%
summarise(
n20 = sum(maf > 0.2),
n = n(),
ts = n20/n,
x = (min(position)+max(position)/2)
)
new_d
br <- d %>%
summarise(
n20 = sum(maf > 0.2),
n = n(),
ts = n20/n,
x = (min(position)+max(position)/2)
)
br
names(br)
br %>% head(5)
br <- d %>%
group_by(bin25k) %>%
summarise(
n20 = sum(maf > 0.2),
n = n(),
ts = n20/n,
x = (min(position)+max(position)/2)
)
br
ggplot(br, aes(bin25k, n, colour=ts)) +
geom_point
ggplot(br, aes(bin25k, n, colour=ts)) +
geom_point()
exp_fraction <- sum(br$n20)/sum(br$n)
exp_fraction
br
br %>%
ungroup() %>%
rowwise() %>%
mutate(p = sum(dbinom(n20:n, n, exp_fraction)),
p2 = pbinom(n20 -1, n, exp_fraction, lower.tail = FALSE))
br
br
br %>%
ungroup() %>%
rowwise() %>%
mutate(p = sum(dbinom(n20:n, n, exp_fraction)),
p2 = pbinom(n20 -1, n, exp_fraction, lower.tail = FALSE))
br
br <- br %>%
summarise(bin25k = bin25k,
n20 = n20,
n = n,
ts = ts
)
br <- br %>%
summarise(bin25k = bin25k,
n20 = n20,
n = n,
ts = ts
)
br <- d %>%
group_by(bin25k) %>%
summarise(
n20 = sum(maf > 0.2),
n = n(),
ts = n20/n,
x = (min(position)+max(position)/2)
)
br
br %>%
ungroup() %>%
rowwise() %>%
mutate(p = sum(dbinom(n20:n, n, exp_fraction)),
p2 = pbinom(n20 -1, n, exp_fraction, lower.tail = FALSE))
ggplot(br, aes(bin25k, p)) +
geom_point()
ggplot(br, aes(bin25k, -log10(p))) +
geom_point()
br %>%
arrange(p)
br
br %>%
ungroup() %>%
rowwise() %>%
mutate(p = sum(dbinom(n20:n, n, exp_fraction)),
p2 = pbinom(n20 -1, n, exp_fraction, lower.tail = FALSE))
br %>%
arrange(p)
br <- br %>%
ungroup() %>%
rowwise() %>%
mutate(p = sum(dbinom(n20:n, n, exp_fraction)),
p2 = pbinom(n20 -1, n, exp_fraction, lower.tail = FALSE))
br
br %>%
arrange(p)
ggplot(br, aes(bin25k, p)) +
geom_point()
ggplot(br, aes(bin25k, -log10(p))) +
geom_point()
d %>%
arrange(position) %>%
mutate(SNPnumber = row_number())
br[10,]
br[,4]
d %>%
arrange(position) %>%
mutate(SNPnumber = row_number())
new_br <- d %>%
group_by(bin25k) %>%
summarise(
n20 = sum(maf > 0.5),
n = n(),
ts = n20/n,
x = (min(position)+max(position)/2)
)
new_br
new_br <- new_br %>%
mutate(bin100k = (position %/% 100) * 100)
new_d <- d %>%
mutate(bin100k = (position %/% 100) * 100)
new_br <- new_d %>%
group_by(bin100k) %>%
summarise(
n20 = sum(maf > 0.5),
n = n(),
ts = n20/n,
x = (min(position)+max(position)/2)
)
new_br <- new_d %>%
group_by(bin100k) %>%
summarise(
n20 = sum(maf > 0.05),
n = n(),
ts = n20/n,
x = (min(position)+max(position)/2)
)
new_d
d = d %>%
filter(population=="EUR") %>%
mutate(maf=ifelse(frequency>0.5, 1-frequency, frequency)) %>%
filter(maf > 0) %>%
mutate(population=factor(population),
reference_allele=factor(reference_allele),
alternative_allele=factor(alternative_allele))
new_d <- d %>%
mutate(bin100k = (position %/% 100) * 100)
new_d
d = read_delim(file="1000g.allele.frequencies.tsv.gz",delim=c("\t"))
new_d <- d %>%
mutate(bin100k = (position %/% 100) * 100)
new_d
new_br <- new_d %>%
group_by(bin100k) %>%
summarise(
n20 = sum(maf > 0.05),
n = n(),
ts = n20/n,
x = (min(position)+max(position)/2)
)
new_br <- new_d %>%
group_by(bin100k) %>%
summarise(
n20 = sum(maf > 0.05),
n = n(),
ts = n20/n,
x = (min(position)+max(position)/2)
)
filter(new_d, maf>0.05)
filter(new_d, maf>0.2)
new_d
new_d <- d %>%
mutate(bin100k = (position %/% 100) * 100)
new_d
d = d %>%
filter(population=="EUR") %>%
mutate(maf=ifelse(frequency>0.5, 1-frequency, frequency)) %>%
filter(maf > 0) %>%
mutate(population=factor(population),
reference_allele=factor(reference_allele),
alternative_allele=factor(alternative_allele))
new_d <- d %>%
mutate(bin100k = (position %/% 100) * 100)
new_d
filter(new_d, maf>0.2)
new_br <- new_d %>%
group_by(bin100k) %>%
summarise(
n20 = sum(maf > 0.05),
n = n(),
ts = n20/n,
x = (min(position)+max(position)/2)
)
new_br
d = read_delim(file="1000g.allele.frequencies.tsv.gz",delim=c("\t"))
d = d %>%
mutate(maf=ifelse(frequency>0.5, 1-frequency, frequency)) %>%
filter(maf > 0) %>%
mutate(population=factor(population),
reference_allele=factor(reference_allele),
alternative_allele=factor(alternative_allele))
new_d <- d %>%
mutate(bin100k = (position %/% 100) * 100)
new_br <- new_d %>%
group_by(bin100k) %>%
summarise(
n20 = sum(maf > 0.05),
n = n(),
ts = n20/n,
x = (min(position)+max(position)/2)
)
d %>%
arrange(position) %>%
mutate(SNPnumber = row_number())
d <- d %>%
mutate(snpbins = (SNPnumber %/% 500) * 500)
d %>%
arrange(position) %>%
mutate(SNPnumber = row_number())
d <- d %>%
mutate(snpbins = (SNPnumber %/% 500) * 500)
d <- d %>%
arrange(position) %>%
mutate(SNPnumber = row_number())
d <- d %>%
mutate(snpbins = (SNPnumber %/% 500) * 500)
p_exp = 0.5
br <- d %>%
muatate(bin = position %/% 100000) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = x = (min(position)+max(position)/2)
) %>%
mutate(p = pbinom(nhigh - 1, n, p_exp, lower.tail = FALSE))
br <- d %>%
muatate(bin = position %/% 100000) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = x = (min(position)+max(position)/2)
) %>%
mutate(p = pbinom(nhigh - 1, n, p_exp, lower.tail = FALSE))
br <- d %>%
muatate(bin = position %/% 100000) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = x = (min(position)+max(position)/2)
) %>%
mutate(p = pbinom(nhigh - 1, n, p_exp, lower.tail = FALSE))
br <- d %>%
muatate(bin = position %/% 100000) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = x = (min(position)+max(position)/2)
)
br <- d %>%
muatate(bin = position %/% 100000) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = x = (min(position)+max(position)/2))
br <- d %>%
muatate(bin = position %/% 100000) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
)
br <- d %>%
muatate(bin = (position %/% 100000)) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
)
br <- d %>%
muatate(bin = position %/% 100000) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
)
br <- d %>%
muatate(bin = (position %/% 100) * 100) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
)
d
br <- d %>%
muatate(bin = position %/% 100000) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
)
br <- d %>%
muatate(bin = position %/% 10000) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
)
br <- d %>%
muatate(bin = position %/% 1000) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
)
br <- d %>%
muatate(bin = (position %/% 100) * 100) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
)
br <- d %>%
muatate(bin = (position %/% 100) * 100) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
)
br <- d %>%
muatate(bin = (position %/% 100) * 100) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
)
br <- d %>%
muatate(bin = (position %/% 100) * 100) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
)
br <- d %>%
muatate(bin100k = (position %/% 100) * 100) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
)
br <- d %>%
muatate(bin = (position %/% 100) * 100) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
)
br <- d %>%
mutate(bin = (position %/% 100) * 100) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
)
br <- d %>%
mutate(bin = (position %/% 100) * 100) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
) %>%
mutate(p = pbinom(nhigh-1, n, p_exp, lower.tail = FALSE))
br <- d %>%
mutate(bin = (position %/% 100) * 100) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.05),
n = n(),
x = (min(position)+max(position)/2)
) %>%
rowwise() %>%
mutate(p = pbinom(nhigh-1, n, p_exp, lower.tail = FALSE))
br <- d %>%
mutate(bin = position %/% 100000) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.2),
n = n(),
x = (min(position)+max(position)/2)
) %>%
rowwise() %>%
mutate(p = pbinom(nhigh-1, n, p_exp, lower.tail = FALSE))
br
ggplot(br, aes(x=x, y=-log10(p))) +
geom_point() +
facet_wrap(~population)
br <- d %>%
mutate(bin = (position %/% 100000) * 100000) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.2),
n = n(),
x = (min(position)+max(position)/2)
) %>%
rowwise() %>% # not neccessary
mutate(p = pbinom(nhigh-1, n, p_exp, lower.tail = FALSE))
ggplot(br, aes(x=x, y=-log10(p))) +
geom_point() +
facet_wrap(~population)
d = read_delim(file="1000g.allele.frequencies.tsv.gz",delim=c("\t"))
library(tidyverse)
d = read_delim(file="1000g.allele.frequencies.tsv.gz",delim=c("\t"))
d = d %>%
mutate(maf=ifelse(frequency>0.5, 1-frequency, frequency)) %>%
filter(maf > 0) %>%
mutate(population=factor(population),
reference_allele=factor(reference_allele),
alternative_allele=factor(alternative_allele))
new_d <- d %>%
mutate(bin100k = (position %/% 100) * 100)
new_br <- new_d %>%
group_by(bin100k) %>%
summarise(
n20 = sum(maf > 0.05),
n = n(),
ts = n20/n,
x = (min(position)+max(position)/2)
)
br <- new_br %>%
mutate(bin = (position %/% 100000) * 100000) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.2),
n = n(),
x = (min(position)+max(position)/2)
) %>%
rowwise() %>% # not neccessary
mutate(p = pbinom(nhigh-1, n, p_exp, lower.tail = FALSE))
new_br <- new_br %>%
mutate(snpbins = (SNPnumber %/% 500) * 500)
new_br <- new_br %>%
arrange(position) %>%
mutate(SNPnumber = row_number())
d = d %>%
mutate(maf=ifelse(frequency>0.5, 1-frequency, frequency)) %>%
filter(maf > 0) %>%
mutate(population=factor(population),
reference_allele=factor(reference_allele),
alternative_allele=factor(alternative_allele))
new_d <- d %>%
mutate(bin100k = (position %/% 100) * 100)
new_br <- new_d %>%
group_by(bin100k) %>%
summarise(
n20 = sum(maf > 0.05),
n = n(),
ts = n20/n,
x = (min(position)+max(position)/2)
)
d = d %>%
mutate(maf=ifelse(frequency>0.5, 1-frequency, frequency)) %>%
filter(maf > 0) %>%
mutate(population=factor(population),
reference_allele=factor(reference_allele),
alternative_allele=factor(alternative_allele))
br <- d %>%
mutate(bin = position %/% 100000) %>%
group_by(bin, population) %>%
summarize(nhigh = sum(maf>0.2),
n = n(),
x = (min(position)+max(position)/2)
) %>%
rowwise() %>% # not neccessary
mutate(p = pbinom(nhigh-1, n, p_exp, lower.tail = FALSE))
ggplot(br, aes(x=x, y=-log10(p))) +
geom_point() +
facet_wrap(~population)
