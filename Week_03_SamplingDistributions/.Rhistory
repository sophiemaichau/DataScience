setwd(dir = "/Users/tbata/Dropbox/2017.FALL.Datascience.in.Bioinformatics/Dropbox.Data.Science.in.Bioinformatics/Week_03_SamplingDistributions/") #ADapt to your path here
mammals=read.csv(file = "rsbl20150010supp1.csv", header=T)
head(mammals) # a glimpse of the data
mammals %>% filter(Species == "Chimp") -> Only_Chimps
library(abd)
source('~/Dropbox/2017.FALL.Datascience.in.Bioinformatics/Week_03/Rsession_week_03_SamplingVariation.R', echo=TRUE)
install.packages("abd") #First install the abd library that is a companion to the abd textbook.
library(abd)
library(tidyverse) # you can also load directly tidyverse
data("HumanGeneLengths") # loading in R the human gene length dataset
myRandomNumbers = rnorm(n = 10^4, mean=0, sd=1) # In one go you generate 10^4 draws from a standard normal distribution
summary(HumanGeneLengths) # Q: What is the unit of gene length?
MySmallSample= sample(x = HumanGeneLengths$gene.length, size = 30, replace = T) ## 30 genes sampled WITH replacement
MyBigSample= sample(x = HumanGeneLengths$gene.length, size = length(HumanGeneLengths$gene.length), replace = F)
summary(MyBigSample)
my100Means=rep(-9,100)
for (i in 1:100){
myNewSample=sample(HumanGeneLengths$gene.length, size = 30, replace = T)
myNewMean=mean(myNewSample)
my100Means[i]=myNewMean
}
summary(my100Means)
ggplot(data = my100Means)
setwd(dir = "/Users/tbata/Dropbox/2017.FALL.Datascience.in.Bioinformatics/Dropbox.Data.Science.in.Bioinformatics/Week_03_SamplingDistributions/") #ADapt to your path here
mammals=read.csv(file = "rsbl20150010supp1.csv", header=T)
head(mammals) # a glimpse of the data
mammals %>% filter(Species == "Chimp") -> Only_Chimps
head(Only_Chimps)
ggplot(data = Only_Chimps, aes(x=RPKM, y=dNdS, color = chrMark)) +
geom_smooth(aes(linetype = "with X"), method = "lm", se = FALSE) +
geom_point(aes(shape = chr)) +
geom_smooth(data = submammals_A, aes(x=RPKM, y=dNdS, color = species, linetype = "no X"), method = "lm", se = FALSE) +
theme_bw() +
ylab("dN/dS") +
xlab("median RPKM")
ggplot(data = Only_Chimps, aes(x=RPKM, y=dNdS, color = chrMark)) +
geom_smooth(aes(linetype = "with X"), method = "lm", se = FALSE) +
geom_point(aes(shape = chr)) +
geom_smooth(data = Only_Chimps, aes(x=RPKM, y=dNdS, color = species, linetype = "no X"), method = "lm", se = FALSE) +
theme_bw() +
ylab("dN/dS") +
xlab("median RPKM")
ggplot(data = Only_Chimps, aes(x=RPKM, y=dNdS, color = chrMark)) +
geom_smooth(aes(linetype = "with X"), method = "lm", se = FALSE) +
geom_point(aes(shape = chr))
ggplot(data = Only_Chimps, aes(x=RPKM, y=dNdS, color = chrMark))
ggplot(data = Only_Chimps, aes(x=RPKM, y=dNdS, color = chrMark)) +
geom_point(aes(shape = chr))
qplot(x = Only_Chimps$RPKM)
qplot(x = log(Only_Chimps$RPKM))
ggplot(x = log(Only_Chimps$RPKM))
ggplot(data = Only_Chimps) +
geom_point(mapping = aes(x = RPKM, y = dNdS)) +
facet_wrap(~ chr, nrow = 2)
ggplot(data = Only_Chimps) +
geom_point(mapping = aes(x = GC3, y = dNdS)) +
facet_wrap(~ chr, nrow = 2)
ggplot(data = Only_Chimps) +
geom_point(mapping = aes(x = log(RPKM), y = dNdS)) +
facet_wrap(~ chr, nrow = 2)
ggplot(data = Only_Chimps) +
geom_point(mapping = aes(x = log(RPKM), y = dNdS))
